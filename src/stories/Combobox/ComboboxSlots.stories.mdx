import { Canvas, Meta, Story } from '@storybook/addon-docs'
import VvCombobox from '@/components/VvCombobox/VvCombobox.vue'
import VvIcon from '@/components/VvIcon/VvIcon.vue'
import { Template } from './Combobox.stories.mdx'
import { defaultTest } from './Combobox.test.ts'
import { defaultArgs, argTypes } from './Combobox.settings'

<Meta
	title="Components/Combobox/Slots"
	component={VvCombobox}
	args={defaultArgs}
	argTypes={argTypes}
/>

<Canvas>
	<Story
		name="Before"
		play={defaultTest}
		args={{
			before: '<div class="vv-badge vv-badge--sm vv-badge--gray vv-badge--outline uppercase">Before</div>',
		}}
		argTypes={{
			before: {
				control: {
					disable: true,
				},
			},
		}}
	>
		{Template.bind()}
	</Story>
</Canvas>

<Canvas>
	<Story
		name="After"
		play={defaultTest}
		args={{
			after: '<div class="vv-badge vv-badge--sm vv-badge--gray vv-badge--outline uppercase">After</div>',
		}}
		argTypes={{
			after: {
				control: {
					disable: true,
				},
			},
		}}
	>
		{Template.bind()}
	</Story>
</Canvas>

<Canvas>
	<Story
		name="Value"
		play={defaultTest}
		args={{
			multiple: true,
		}}
		argTypes={{
			value: {
				control: {
					disable: true,
				},
			},
		}}
	>
		{(args) => ({
			components: { VvCombobox },
			setup() {
				return { args }
			},
			data() {
				return {
					inputValue: undefined,
				}
			},
			template: /*html*/ `
				<vv-combobox v-bind="args" v-model="inputValue" :data-testData="inputValue" data-testId="element">
					<template #before v-if="args.before"><div class="pl-sm flex" v-html="args.before"></div></template>
					<template #hint v-if="args.hint"><span v-html="args.hint"></span></template>
					<template #after v-if="args.after"><div class="pr-sm flex" v-html="args.after"></div></template>
					<template #value="{ selectedOptions }">
						<div v-for="(option, index) in selectedOptions" :key="index" class="vv-badge vv-badge--sm vv-badge--rounded vv-badge--outline uppercase">{{option}}</div>
					</template>
				</vv-combobox>
				<div>Value: <span data-testId="value">{{inputValue}}</span></div> 
			`,
		})}
	</Story>
</Canvas>

<Canvas>
	<Story
		name="Option"
		play={defaultTest}
		args={{
			multiple: true,
		}}
		argTypes={{
			option: {
				control: {
					disable: true,
				},
			},
		}}
	>
		{(args) => ({
			components: { VvCombobox, VvIcon },
			setup() {
				return { args }
			},
			data() {
				return {
					inputValue: undefined,
				}
			},
			template: /*html*/ `
				<vv-combobox v-bind="args" v-model="inputValue" :data-testData="inputValue" data-testId="element">
					<template #before v-if="args.before"><div class="pl-sm flex" v-html="args.before"></div></template>
					<template #hint v-if="args.hint"><span v-html="args.hint"></span></template>
					<template #after v-if="args.after"><div class="pr-sm flex" v-html="args.after"></div></template>
					<template #option="{ option, selected }">
						<div class="flex flex-1 items-center">
							<vv-icon :name="selected ? 'check-circle' : 'circle'" />
							<div class="flex-1 pl-sm">{{ option }}</div>
						</div>
					</template>
				</vv-combobox>
				<div>Value: <span data-testId="value">{{inputValue}}</span></div> 
			`,
		})}
	</Story>
</Canvas>

<Canvas>
	<Story
		name="Hint"
		play={defaultTest}
		args={{
			hint: 'Hint <em class="italic">slot!</em>',
		}}
		argTypes={{
			hint: {
				control: {
					disable: true,
				},
			},
		}}
	>
		{Template.bind()}
	</Story>
</Canvas>
